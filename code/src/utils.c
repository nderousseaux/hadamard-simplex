#include <stdio.h>
#include <stdlib.h>

#include "../include/utils.h"

//Matrice génératrice de Hadamard
unsigned short g[N] = {
    0b1000000001111111,
    0b0100001110001111,
    0b0010010110110011,
    0b0001011011010101,
};

//Matrice génératrice de Hadamard simplexe
unsigned short gs[N] = {
    0b100000001111111,
    0b010001110001111,
    0b001010110110011,
    0b000111011010101,
};

//Matrice de parité du simplexe
unsigned short hs[NH] = {
    0b0011100000000000,
    0b0101010000000000,
    0b0110001000000000,
    0b0111000100000000,
    0b1001000010000000,
    0b1010000001000000,
    0b1011000000100000,
    0b1100000000010000,
    0b1101000000001000,
    0b1110000000000100,
    0b1111000000000010
};

//Matrice de parité du simplexe, Transposée
unsigned short hsT[NHT] = {
    0b00001111111,
    0b01110001111,
    0b10110110011,
    0b11011010101,
    0b10000000000,
    0b01000000000,
    0b00100000000,
    0b00010000000,
    0b00001000000,
    0b00000100000,
    0b00000010000,
    0b00000001000,
    0b00000000100,
    0b00000000010,
    0b00000000001
};

//Liste des erreurs possible
unsigned short errors[NB_ERRORS] = {
    0b0000000000000010,
    0b0000000000000100,
    0b0000000000000110,
    0b0000000000001000,
    0b0000000000001010,
    0b0000000000001100,
    0b0000000000001110,
    0b0000000000010000,
    0b0000000000010010,
    0b0000000000010100,
    0b0000000000010110,
    0b0000000000011000,
    0b0000000000011010,
    0b0000000000011100,
    0b0000000000100000,
    0b0000000000100010,
    0b0000000000100100,
    0b0000000000100110,
    0b0000000000101000,
    0b0000000000101010,
    0b0000000000101100,
    0b0000000000110000,
    0b0000000000110010,
    0b0000000000110100,
    0b0000000000111000,
    0b0000000001000000,
    0b0000000001000010,
    0b0000000001000100,
    0b0000000001000110,
    0b0000000001001000,
    0b0000000001001010,
    0b0000000001001100,
    0b0000000001010000,
    0b0000000001010010,
    0b0000000001010100,
    0b0000000001011000,
    0b0000000001100000,
    0b0000000001100010,
    0b0000000001100100,
    0b0000000001101000,
    0b0000000001110000,
    0b0000000010000000,
    0b0000000010000010,
    0b0000000010000100,
    0b0000000010000110,
    0b0000000010001000,
    0b0000000010001010,
    0b0000000010001100,
    0b0000000010010000,
    0b0000000010010010,
    0b0000000010010100,
    0b0000000010011000,
    0b0000000010100000,
    0b0000000010100010,
    0b0000000010100100,
    0b0000000010101000,
    0b0000000010110000,
    0b0000000011000000,
    0b0000000011000010,
    0b0000000011000100,
    0b0000000011001000,
    0b0000000011010000,
    0b0000000011100000,
    0b0000000100000000,
    0b0000000100000010,
    0b0000000100000100,
    0b0000000100000110,
    0b0000000100001000,
    0b0000000100001010,
    0b0000000100001100,
    0b0000000100010000,
    0b0000000100010010,
    0b0000000100010100,
    0b0000000100011000,
    0b0000000100100000,
    0b0000000100100010,
    0b0000000100100100,
    0b0000000100101000,
    0b0000000100110000,
    0b0000000101000000,
    0b0000000101000010,
    0b0000000101000100,
    0b0000000101001000,
    0b0000000101010000,
    0b0000000101100000,
    0b0000000110000000,
    0b0000000110000010,
    0b0000000110000100,
    0b0000000110001000,
    0b0000000110010000,
    0b0000000110100000,
    0b0000000111000000,
    0b0000001000000000,
    0b0000001000000010,
    0b0000001000000100,
    0b0000001000000110,
    0b0000001000001000,
    0b0000001000001010,
    0b0000001000001100,
    0b0000001000010000,
    0b0000001000010010,
    0b0000001000010100,
    0b0000001000011000,
    0b0000001000100000,
    0b0000001000100010,
    0b0000001000100100,
    0b0000001000101000,
    0b0000001000110000,
    0b0000001001000000,
    0b0000001001000010,
    0b0000001001000100,
    0b0000001001001000,
    0b0000001001010000,
    0b0000001001100000,
    0b0000001010000000,
    0b0000001010000010,
    0b0000001010000100,
    0b0000001010001000,
    0b0000001010010000,
    0b0000001010100000,
    0b0000001011000000,
    0b0000001100000000,
    0b0000001100000010,
    0b0000001100000100,
    0b0000001100001000,
    0b0000001100010000,
    0b0000001100100000,
    0b0000001101000000,
    0b0000001110000000,
    0b0000010000000000,
    0b0000010000000010,
    0b0000010000000100,
    0b0000010000000110,
    0b0000010000001000,
    0b0000010000001010,
    0b0000010000001100,
    0b0000010000010000,
    0b0000010000010010,
    0b0000010000010100,
    0b0000010000011000,
    0b0000010000100000,
    0b0000010000100010,
    0b0000010000100100,
    0b0000010000101000,
    0b0000010000110000,
    0b0000010001000000,
    0b0000010001000010,
    0b0000010001000100,
    0b0000010001001000,
    0b0000010001010000,
    0b0000010001100000,
    0b0000010010000000,
    0b0000010010000010,
    0b0000010010000100,
    0b0000010010001000,
    0b0000010010010000,
    0b0000010010100000,
    0b0000010011000000,
    0b0000010100000000,
    0b0000010100000010,
    0b0000010100000100,
    0b0000010100001000,
    0b0000010100010000,
    0b0000010100100000,
    0b0000010101000000,
    0b0000010110000000,
    0b0000011000000000,
    0b0000011000000010,
    0b0000011000000100,
    0b0000011000001000,
    0b0000011000010000,
    0b0000011000100000,
    0b0000011001000000,
    0b0000011010000000,
    0b0000011100000000,
    0b0000100000000000,
    0b0000100000000010,
    0b0000100000000100,
    0b0000100000000110,
    0b0000100000001000,
    0b0000100000001010,
    0b0000100000001100,
    0b0000100000010000,
    0b0000100000010010,
    0b0000100000010100,
    0b0000100000011000,
    0b0000100000100000,
    0b0000100000100010,
    0b0000100000100100,
    0b0000100000101000,
    0b0000100000110000,
    0b0000100001000000,
    0b0000100001000010,
    0b0000100001000100,
    0b0000100001001000,
    0b0000100001010000,
    0b0000100001100000,
    0b0000100010000000,
    0b0000100010000010,
    0b0000100010000100,
    0b0000100010001000,
    0b0000100010010000,
    0b0000100010100000,
    0b0000100011000000,
    0b0000100100000000,
    0b0000100100000010,
    0b0000100100000100,
    0b0000100100001000,
    0b0000100100010000,
    0b0000100100100000,
    0b0000100101000000,
    0b0000100110000000,
    0b0000101000000000,
    0b0000101000000010,
    0b0000101000000100,
    0b0000101000001000,
    0b0000101000010000,
    0b0000101000100000,
    0b0000101001000000,
    0b0000101010000000,
    0b0000101100000000,
    0b0000110000000000,
    0b0000110000000010,
    0b0000110000000100,
    0b0000110000001000,
    0b0000110000010000,
    0b0000110000100000,
    0b0000110001000000,
    0b0000110010000000,
    0b0000110100000000,
    0b0000111000000000,
    0b0001000000000000,
    0b0001000000000010,
    0b0001000000000100,
    0b0001000000000110,
    0b0001000000001000,
    0b0001000000001010,
    0b0001000000001100,
    0b0001000000010000,
    0b0001000000010010,
    0b0001000000010100,
    0b0001000000011000,
    0b0001000000100000,
    0b0001000000100010,
    0b0001000000100100,
    0b0001000000101000,
    0b0001000000110000,
    0b0001000001000000,
    0b0001000001000010,
    0b0001000001000100,
    0b0001000001001000,
    0b0001000001010000,
    0b0001000001100000,
    0b0001000010000000,
    0b0001000010000010,
    0b0001000010000100,
    0b0001000010001000,
    0b0001000010010000,
    0b0001000010100000,
    0b0001000011000000,
    0b0001000100000000,
    0b0001000100000010,
    0b0001000100000100,
    0b0001000100001000,
    0b0001000100010000,
    0b0001000100100000,
    0b0001000101000000,
    0b0001000110000000,
    0b0001001000000000,
    0b0001001000000010,
    0b0001001000000100,
    0b0001001000001000,
    0b0001001000010000,
    0b0001001000100000,
    0b0001001001000000,
    0b0001001010000000,
    0b0001001100000000,
    0b0001010000000000,
    0b0001010000000010,
    0b0001010000000100,
    0b0001010000001000,
    0b0001010000010000,
    0b0001010000100000,
    0b0001010001000000,
    0b0001010010000000,
    0b0001010100000000,
    0b0001011000000000,
    0b0001100000000000,
    0b0001100000000010,
    0b0001100000000100,
    0b0001100000001000,
    0b0001100000010000,
    0b0001100000100000,
    0b0001100001000000,
    0b0001100010000000,
    0b0001100100000000,
    0b0001101000000000,
    0b0001110000000000,
    0b0010000000000000,
    0b0010000000000010,
    0b0010000000000100,
    0b0010000000000110,
    0b0010000000001000,
    0b0010000000001010,
    0b0010000000001100,
    0b0010000000010000,
    0b0010000000010010,
    0b0010000000010100,
    0b0010000000011000,
    0b0010000000100000,
    0b0010000000100010,
    0b0010000000100100,
    0b0010000000101000,
    0b0010000000110000,
    0b0010000001000000,
    0b0010000001000010,
    0b0010000001000100,
    0b0010000001001000,
    0b0010000001010000,
    0b0010000001100000,
    0b0010000010000000,
    0b0010000010000010,
    0b0010000010000100,
    0b0010000010001000,
    0b0010000010010000,
    0b0010000010100000,
    0b0010000011000000,
    0b0010000100000000,
    0b0010000100000010,
    0b0010000100000100,
    0b0010000100001000,
    0b0010000100010000,
    0b0010000100100000,
    0b0010000101000000,
    0b0010000110000000,
    0b0010001000000000,
    0b0010001000000010,
    0b0010001000000100,
    0b0010001000001000,
    0b0010001000010000,
    0b0010001000100000,
    0b0010001001000000,
    0b0010001010000000,
    0b0010001100000000,
    0b0010010000000000,
    0b0010010000000010,
    0b0010010000000100,
    0b0010010000001000,
    0b0010010000010000,
    0b0010010000100000,
    0b0010010001000000,
    0b0010010010000000,
    0b0010010100000000,
    0b0010011000000000,
    0b0010100000000000,
    0b0010100000000010,
    0b0010100000000100,
    0b0010100000001000,
    0b0010100000010000,
    0b0010100000100000,
    0b0010100001000000,
    0b0010100010000000,
    0b0010100100000000,
    0b0010101000000000,
    0b0010110000000000,
    0b0011000000000000,
    0b0011000000000010,
    0b0011000000000100,
    0b0011000000001000,
    0b0011000000010000,
    0b0011000000100000,
    0b0011000001000000,
    0b0011000010000000,
    0b0011000100000000,
    0b0011001000000000,
    0b0011010000000000,
    0b0011100000000000,
    0b0100000000000000,
    0b0100000000000010,
    0b0100000000000100,
    0b0100000000000110,
    0b0100000000001000,
    0b0100000000001010,
    0b0100000000001100,
    0b0100000000010000,
    0b0100000000010010,
    0b0100000000010100,
    0b0100000000011000,
    0b0100000000100000,
    0b0100000000100010,
    0b0100000000100100,
    0b0100000000101000,
    0b0100000000110000,
    0b0100000001000000,
    0b0100000001000010,
    0b0100000001000100,
    0b0100000001001000,
    0b0100000001010000,
    0b0100000001100000,
    0b0100000010000000,
    0b0100000010000010,
    0b0100000010000100,
    0b0100000010001000,
    0b0100000010010000,
    0b0100000010100000,
    0b0100000011000000,
    0b0100000100000000,
    0b0100000100000010,
    0b0100000100000100,
    0b0100000100001000,
    0b0100000100010000,
    0b0100000100100000,
    0b0100000101000000,
    0b0100000110000000,
    0b0100001000000000,
    0b0100001000000010,
    0b0100001000000100,
    0b0100001000001000,
    0b0100001000010000,
    0b0100001000100000,
    0b0100001001000000,
    0b0100001010000000,
    0b0100001100000000,
    0b0100010000000000,
    0b0100010000000010,
    0b0100010000000100,
    0b0100010000001000,
    0b0100010000010000,
    0b0100010000100000,
    0b0100010001000000,
    0b0100010010000000,
    0b0100010100000000,
    0b0100011000000000,
    0b0100100000000000,
    0b0100100000000010,
    0b0100100000000100,
    0b0100100000001000,
    0b0100100000010000,
    0b0100100000100000,
    0b0100100001000000,
    0b0100100010000000,
    0b0100100100000000,
    0b0100101000000000,
    0b0100110000000000,
    0b0101000000000000,
    0b0101000000000010,
    0b0101000000000100,
    0b0101000000001000,
    0b0101000000010000,
    0b0101000000100000,
    0b0101000001000000,
    0b0101000010000000,
    0b0101000100000000,
    0b0101001000000000,
    0b0101010000000000,
    0b0101100000000000,
    0b0110000000000000,
    0b0110000000000010,
    0b0110000000000100,
    0b0110000000001000,
    0b0110000000010000,
    0b0110000000100000,
    0b0110000001000000,
    0b0110000010000000,
    0b0110000100000000,
    0b0110001000000000,
    0b0110010000000000,
    0b0110100000000000,
    0b0111000000000000,
    0b1000000000000000,
    0b1000000000000010,
    0b1000000000000100,
    0b1000000000000110,
    0b1000000000001000,
    0b1000000000001010,
    0b1000000000001100,
    0b1000000000010000,
    0b1000000000010010,
    0b1000000000010100,
    0b1000000000011000,
    0b1000000000100000,
    0b1000000000100010,
    0b1000000000100100,
    0b1000000000101000,
    0b1000000000110000,
    0b1000000001000000,
    0b1000000001000010,
    0b1000000001000100,
    0b1000000001001000,
    0b1000000001010000,
    0b1000000001100000,
    0b1000000010000000,
    0b1000000010000010,
    0b1000000010000100,
    0b1000000010001000,
    0b1000000010010000,
    0b1000000010100000,
    0b1000000011000000,
    0b1000000100000000,
    0b1000000100000010,
    0b1000000100000100,
    0b1000000100001000,
    0b1000000100010000,
    0b1000000100100000,
    0b1000000101000000,
    0b1000000110000000,
    0b1000001000000000,
    0b1000001000000010,
    0b1000001000000100,
    0b1000001000001000,
    0b1000001000010000,
    0b1000001000100000,
    0b1000001001000000,
    0b1000001010000000,
    0b1000001100000000,
    0b1000010000000000,
    0b1000010000000010,
    0b1000010000000100,
    0b1000010000001000,
    0b1000010000010000,
    0b1000010000100000,
    0b1000010001000000,
    0b1000010010000000,
    0b1000010100000000,
    0b1000011000000000,
    0b1000100000000000,
    0b1000100000000010,
    0b1000100000000100,
    0b1000100000001000,
    0b1000100000010000,
    0b1000100000100000,
    0b1000100001000000,
    0b1000100010000000,
    0b1000100100000000,
    0b1000101000000000,
    0b1000110000000000,
    0b1001000000000000,
    0b1001000000000010,
    0b1001000000000100,
    0b1001000000001000,
    0b1001000000010000,
    0b1001000000100000,
    0b1001000001000000,
    0b1001000010000000,
    0b1001000100000000,
    0b1001001000000000,
    0b1001010000000000,
    0b1001100000000000,
    0b1010000000000000,
    0b1010000000000010,
    0b1010000000000100,
    0b1010000000001000,
    0b1010000000010000,
    0b1010000000100000,
    0b1010000001000000,
    0b1010000010000000,
    0b1010000100000000,
    0b1010001000000000,
    0b1010010000000000,
    0b1010100000000000,
    0b1011000000000000,
    0b1100000000000000,
    0b1100000000000010,
    0b1100000000000100,
    0b1100000000001000,
    0b1100000000010000,
    0b1100000000100000,
    0b1100000001000000,
    0b1100000010000000,
    0b1100000100000000,
    0b1100001000000000,
    0b1100010000000000,
    0b1100100000000000,
    0b1101000000000000,
    0b1110000000000000
};

//Liste des syndromes associées aux erreurs
unsigned short syndromes[NB_ERRORS] = {
    0b0000000000100000,
    0b0000000001000000,
    0b0000000001100000,
    0b0000000010000000,
    0b0000000010100000,
    0b0000000011000000,
    0b0000000011100000,
    0b0000000100000000,
    0b0000000100100000,
    0b0000000101000000,
    0b0000000101100000,
    0b0000000110000000,
    0b0000000110100000,
    0b0000000111000000,
    0b0000001000000000,
    0b0000001000100000,
    0b0000001001000000,
    0b0000001001100000,
    0b0000001010000000,
    0b0000001010100000,
    0b0000001011000000,
    0b0000001100000000,
    0b0000001100100000,
    0b0000001101000000,
    0b0000001110000000,
    0b0000010000000000,
    0b0000010000100000,
    0b0000010001000000,
    0b0000010001100000,
    0b0000010010000000,
    0b0000010010100000,
    0b0000010011000000,
    0b0000010100000000,
    0b0000010100100000,
    0b0000010101000000,
    0b0000010110000000,
    0b0000011000000000,
    0b0000011000100000,
    0b0000011001000000,
    0b0000011010000000,
    0b0000011100000000,
    0b0000100000000000,
    0b0000100000100000,
    0b0000100001000000,
    0b0000100001100000,
    0b0000100010000000,
    0b0000100010100000,
    0b0000100011000000,
    0b0000100100000000,
    0b0000100100100000,
    0b0000100101000000,
    0b0000100110000000,
    0b0000101000000000,
    0b0000101000100000,
    0b0000101001000000,
    0b0000101010000000,
    0b0000101100000000,
    0b0000110000000000,
    0b0000110000100000,
    0b0000110001000000,
    0b0000110010000000,
    0b0000110100000000,
    0b0000111000000000,
    0b0001000000000000,
    0b0001000000100000,
    0b0001000001000000,
    0b0001000001100000,
    0b0001000010000000,
    0b0001000010100000,
    0b0001000011000000,
    0b0001000100000000,
    0b0001000100100000,
    0b0001000101000000,
    0b0001000110000000,
    0b0001001000000000,
    0b0001001000100000,
    0b0001001001000000,
    0b0001001010000000,
    0b0001001100000000,
    0b0001010000000000,
    0b0001010000100000,
    0b0001010001000000,
    0b0001010010000000,
    0b0001010100000000,
    0b0001011000000000,
    0b0001100000000000,
    0b0001100000100000,
    0b0001100001000000,
    0b0001100010000000,
    0b0001100100000000,
    0b0001101000000000,
    0b0001110000000000,
    0b0010000000000000,
    0b0010000000100000,
    0b0010000001000000,
    0b0010000001100000,
    0b0010000010000000,
    0b0010000010100000,
    0b0010000011000000,
    0b0010000100000000,
    0b0010000100100000,
    0b0010000101000000,
    0b0010000110000000,
    0b0010001000000000,
    0b0010001000100000,
    0b0010001001000000,
    0b0010001010000000,
    0b0010001100000000,
    0b0010010000000000,
    0b0010010000100000,
    0b0010010001000000,
    0b0010010010000000,
    0b0010010100000000,
    0b0010011000000000,
    0b0010100000000000,
    0b0010100000100000,
    0b0010100001000000,
    0b0010100010000000,
    0b0010100100000000,
    0b0010101000000000,
    0b0010110000000000,
    0b0011000000000000,
    0b0011000000100000,
    0b0011000001000000,
    0b0011000010000000,
    0b0011000100000000,
    0b0011001000000000,
    0b0011010000000000,
    0b0011100000000000,
    0b0100000000000000,
    0b0100000000100000,
    0b0100000001000000,
    0b0100000001100000,
    0b0100000010000000,
    0b0100000010100000,
    0b0100000011000000,
    0b0100000100000000,
    0b0100000100100000,
    0b0100000101000000,
    0b0100000110000000,
    0b0100001000000000,
    0b0100001000100000,
    0b0100001001000000,
    0b0100001010000000,
    0b0100001100000000,
    0b0100010000000000,
    0b0100010000100000,
    0b0100010001000000,
    0b0100010010000000,
    0b0100010100000000,
    0b0100011000000000,
    0b0100100000000000,
    0b0100100000100000,
    0b0100100001000000,
    0b0100100010000000,
    0b0100100100000000,
    0b0100101000000000,
    0b0100110000000000,
    0b0101000000000000,
    0b0101000000100000,
    0b0101000001000000,
    0b0101000010000000,
    0b0101000100000000,
    0b0101001000000000,
    0b0101010000000000,
    0b0101100000000000,
    0b0110000000000000,
    0b0110000000100000,
    0b0110000001000000,
    0b0110000010000000,
    0b0110000100000000,
    0b0110001000000000,
    0b0110010000000000,
    0b0110100000000000,
    0b0111000000000000,
    0b1000000000000000,
    0b1000000000100000,
    0b1000000001000000,
    0b1000000001100000,
    0b1000000010000000,
    0b1000000010100000,
    0b1000000011000000,
    0b1000000100000000,
    0b1000000100100000,
    0b1000000101000000,
    0b1000000110000000,
    0b1000001000000000,
    0b1000001000100000,
    0b1000001001000000,
    0b1000001010000000,
    0b1000001100000000,
    0b1000010000000000,
    0b1000010000100000,
    0b1000010001000000,
    0b1000010010000000,
    0b1000010100000000,
    0b1000011000000000,
    0b1000100000000000,
    0b1000100000100000,
    0b1000100001000000,
    0b1000100010000000,
    0b1000100100000000,
    0b1000101000000000,
    0b1000110000000000,
    0b1001000000000000,
    0b1001000000100000,
    0b1001000001000000,
    0b1001000010000000,
    0b1001000100000000,
    0b1001001000000000,
    0b1001010000000000,
    0b1001100000000000,
    0b1010000000000000,
    0b1010000000100000,
    0b1010000001000000,
    0b1010000010000000,
    0b1010000100000000,
    0b1010001000000000,
    0b1010010000000000,
    0b1010100000000000,
    0b1011000000000000,
    0b1100000000000000,
    0b1100000000100000,
    0b1100000001000000,
    0b1100000010000000,
    0b1100000100000000,
    0b1100001000000000,
    0b1100010000000000,
    0b1100100000000000,
    0b1101000000000000,
    0b1110000000000000,
    0b1101101010100000,
    0b1101101010000000,
    0b1101101011100000,
    0b1101101011000000,
    0b1101101000100000,
    0b1101101000000000,
    0b1101101001100000,
    0b1101101110100000,
    0b1101101110000000,
    0b1101101111100000,
    0b1101101100100000,
    0b1101100010100000,
    0b1101100010000000,
    0b1101100011100000,
    0b1101100000100000,
    0b1101100110100000,
    0b1101111010100000,
    0b1101111010000000,
    0b1101111011100000,
    0b1101111000100000,
    0b1101111110100000,
    0b1101110010100000,
    0b1101001010100000,
    0b1101001010000000,
    0b1101001011100000,
    0b1101001000100000,
    0b1101001110100000,
    0b1101000010100000,
    0b1101011010100000,
    0b1100101010100000,
    0b1100101010000000,
    0b1100101011100000,
    0b1100101000100000,
    0b1100101110100000,
    0b1100100010100000,
    0b1100111010100000,
    0b1100001010100000,
    0b1111101010100000,
    0b1111101010000000,
    0b1111101011100000,
    0b1111101000100000,
    0b1111101110100000,
    0b1111100010100000,
    0b1111111010100000,
    0b1111001010100000,
    0b1110101010100000,
    0b1001101010100000,
    0b1001101010000000,
    0b1001101011100000,
    0b1001101000100000,
    0b1001101110100000,
    0b1001100010100000,
    0b1001111010100000,
    0b1001001010100000,
    0b1000101010100000,
    0b1011101010100000,
    0b0101101010100000,
    0b0101101010000000,
    0b0101101011100000,
    0b0101101000100000,
    0b0101101110100000,
    0b0101100010100000,
    0b0101111010100000,
    0b0101001010100000,
    0b0100101010100000,
    0b0111101010100000,
    0b0001101010100000,
    0b1011011001100000,
    0b1011011001000000,
    0b1011011000100000,
    0b1011011000000000,
    0b1011011011100000,
    0b1011011011000000,
    0b1011011010100000,
    0b1011011101100000,
    0b1011011101000000,
    0b1011011100100000,
    0b1011011111100000,
    0b1011010001100000,
    0b1011010001000000,
    0b1011010000100000,
    0b1011010011100000,
    0b1011010101100000,
    0b1011001001100000,
    0b1011001001000000,
    0b1011001000100000,
    0b1011001011100000,
    0b1011001101100000,
    0b1011000001100000,
    0b1011111001100000,
    0b1011111001000000,
    0b1011111000100000,
    0b1011111011100000,
    0b1011111101100000,
    0b1011110001100000,
    0b1011101001100000,
    0b1010011001100000,
    0b1010011001000000,
    0b1010011000100000,
    0b1010011011100000,
    0b1010011101100000,
    0b1010010001100000,
    0b1010001001100000,
    0b1010111001100000,
    0b1001011001100000,
    0b1001011001000000,
    0b1001011000100000,
    0b1001011011100000,
    0b1001011101100000,
    0b1001010001100000,
    0b1001001001100000,
    0b1001111001100000,
    0b1000011001100000,
    0b1111011001100000,
    0b1111011001000000,
    0b1111011000100000,
    0b1111011011100000,
    0b1111011101100000,
    0b1111010001100000,
    0b1111001001100000,
    0b1111111001100000,
    0b1110011001100000,
    0b1101011001100000,
    0b0011011001100000,
    0b0011011001000000,
    0b0011011000100000,
    0b0011011011100000,
    0b0011011101100000,
    0b0011010001100000,
    0b0011001001100000,
    0b0011111001100000,
    0b0010011001100000,
    0b0001011001100000,
    0b0111011001100000,
    0b0110110011000000,
    0b0110110011100000,
    0b0110110010000000,
    0b0110110001000000,
    0b0110110111000000,
    0b0110111011000000,
    0b0110100011000000,
    0b0110010011000000,
    0b0111110011000000,
    0b0100110011000000,
    0b0010110011000000,
    0b1110110011000000,
    0b0111000111100000,
    0b0111000111000000,
    0b0111000110100000,
    0b0111000110000000,
    0b0111000101100000,
    0b0111000101000000,
    0b0111000100100000,
    0b0111000011100000,
    0b0111000011000000,
    0b0111000010100000,
    0b0111000001100000,
    0b0111001111100000,
    0b0111001111000000,
    0b0111001110100000,
    0b0111001101100000,
    0b0111001011100000,
    0b0111010111100000,
    0b0111010111000000,
    0b0111010110100000,
    0b0111010101100000,
    0b0111010011100000,
    0b0111011111100000,
    0b0111100111100000,
    0b0111100111000000,
    0b0111100110100000,
    0b0111100101100000,
    0b0111100011100000,
    0b0111101111100000,
    0b0111110111100000,
    0b0110000111100000,
    0b0110000111000000,
    0b0110000110100000,
    0b0110000101100000,
    0b0110000011100000,
    0b0110001111100000,
    0b0110010111100000,
    0b0110100111100000,
    0b0101000111100000,
    0b0101000111000000,
    0b0101000110100000,
    0b0101000101100000,
    0b0101000011100000,
    0b0101001111100000,
    0b0101010111100000,
    0b0101100111100000,
    0b0100000111100000,
    0b0011000111100000,
    0b0011000111000000,
    0b0011000110100000,
    0b0011000101100000,
    0b0011000011100000,
    0b0011001111100000,
    0b0011010111100000,
    0b0011100111100000,
    0b0010000111100000,
    0b0001000111100000,
    0b1111000111100000,
    0b1111000111000000,
    0b1111000110100000,
    0b1111000101100000,
    0b1111000011100000,
    0b1111001111100000,
    0b1111010111100000,
    0b1111100111100000,
    0b1110000111100000,
    0b1101000111100000,
    0b1011000111100000,
    0b1010101101000000,
    0b1010101101100000,
    0b1010101100000000,
    0b1010101111000000,
    0b1010101001000000,
    0b1010100101000000,
    0b1010111101000000,
    0b1010001101000000,
    0b1011101101000000,
    0b1000101101000000,
    0b1110101101000000,
    0b0010101101000000,
    0b1100011110000000,
    0b1100011110100000,
    0b1100011111000000,
    0b1100011100000000,
    0b1100011010000000,
    0b1100010110000000,
    0b1100001110000000,
    0b1100111110000000,
    0b1101011110000000,
    0b1110011110000000,
    0b1000011110000000,
    0b0100011110000000,
    0b0001110100100000,
    0b0000111111100000,
    0b0000111111000000,
    0b0000111110100000,
    0b0000111110000000,
    0b0000111101100000,
    0b0000111101000000,
    0b0000111100100000,
    0b0000111011100000,
    0b0000111011000000,
    0b0000111010100000,
    0b0000111001100000,
    0b0000110111100000,
    0b0000110111000000,
    0b0000110110100000,
    0b0000110101100000,
    0b0000110011100000,
    0b0000101111100000,
    0b0000101111000000,
    0b0000101110100000,
    0b0000101101100000,
    0b0000101011100000,
    0b0000100111100000,
    0b0000011111100000,
    0b0000011111000000,
    0b0000011110100000,
    0b0000011101100000,
    0b0000011011100000,
    0b0000010111100000,
    0b0000001111100000,
    0b0001111111100000,
    0b0001111111000000,
    0b0001111110100000,
    0b0001111101100000,
    0b0001111011100000,
    0b0001110111100000,
    0b0001101111100000,
    0b0001011111100000,
    0b0010111111100000,
    0b0010111111000000,
    0b0010111110100000,
    0b0010111101100000,
    0b0010111011100000,
    0b0010110111100000,
    0b0010101111100000,
    0b0010011111100000,
    0b0011111111100000,
    0b0100111111100000,
    0b0100111111000000,
    0b0100111110100000,
    0b0100111101100000,
    0b0100111011100000,
    0b0100110111100000,
    0b0100101111100000,
    0b0100011111100000,
    0b0101111111100000,
    0b0110111111100000,
    0b1000111111100000,
    0b1000111111000000,
    0b1000111110100000,
    0b1000111101100000,
    0b1000111011100000,
    0b1000110111100000,
    0b1000101111100000,
    0b1000011111100000,
    0b1001111111100000,
    0b1010111111100000,
    0b1100111111100000,
    0b1101010101000000,
    0b1101010101100000,
    0b1101010100000000,
    0b1101010111000000,
    0b1101010001000000,
    0b1101011101000000,
    0b1101000101000000,
    0b1101110101000000,
    0b1100010101000000,
    0b1111010101000000,
    0b1001010101000000,
    0b0101010101000000,
    0b1011100110000000,
    0b1011100110100000,
    0b1011100111000000,
    0b1011100100000000,
    0b1011100010000000,
    0b1011101110000000,
    0b1011110110000000,
    0b1011000110000000,
    0b1010100110000000,
    0b1001100110000000,
    0b1111100110000000,
    0b0011100110000000,
    0b0110001100100000,
    0b0111111000000000,
    0b0111111000100000,
    0b0111111001000000,
    0b0111111010000000,
    0b0111111100000000,
    0b0111110000000000,
    0b0111101000000000,
    0b0111011000000000,
    0b0110111000000000,
    0b0101111000000000,
    0b0011111000000000,
    0b1111111000000000,
    0b1010010010100000,
    0b1100100001100000
};

//Met le n-ième bit du mot m à 1. Retourne le mot modifié
unsigned short set_nth_bit(int n, unsigned short m){
    return (MASK >> n) | m;
}

//Retourne la valeur du n-ième bit du mot m
unsigned short get_nth_bit(int n, unsigned short m){
    return (m >> (15-n)) & 0x1;
}

//Change la valeur du n-ième bit du mot m. Retourne le mot modifié
unsigned short chg_nth_bit(int n, unsigned short m){
    return (MASK >> n) ^ m;
}

//Imprime les k premiers bits de m.
void print_word(int k, unsigned short m){
    for(int i = 0; i<k; i++){
        printf("%d", (int)get_nth_bit(i, m));
    }
    printf("\n");
}

//Rajoute les bits de parité sur un mot de taille 4. Retourne le mot modifié
unsigned short encode_had_sys(unsigned short m){
    unsigned short res = ZERO;
    for(int i = 0; i<N; i++){
        res ^= g[i] & (get_nth_bit(i, m) ? ONE : ZERO);
    }
    return res;
}

//Rajoute les bits de parité sur un mot de taille 4. Retourne le mot modifié (simplexe)
unsigned short encode_simplexe(unsigned short m){
    unsigned short res = ZERO;
    for(int i = 0; i<N; i++){
        res ^= gs[i] & (get_nth_bit(i, m) ? ONE : ZERO);
    }
    return res<<1;
}

//Compte le nombre bit à 1 dans un mot (poid de hamming)
int cnt_bits(unsigned short n){
    int res = 0;
    while(n != 0){
        n &= (n-1);
        res++;
    }
    return res;
}

//Calcule la distance du code représenté par G
int dist_code_hds(){
    //Le code hadamard est un code linéaire : donc sa distance est égale au minimum du poid de hamming de chaque mot (non nul) 
    int res = 0;

    //On cherche tous les codes possible à 4 bits
    for(unsigned short i = 0; i<2<<(N-1); i++){
        unsigned short m = encode_had_sys(i<<(16-N));
        int nb_bits = cnt_bits(m);
        if (nb_bits != 0 || nb_bits < res){
            res = nb_bits;
        }
    }
    return res;
}

//Calcule la distance du code représenté par Gs
int dist_code_simplexe(){
    //Le code hadamard est un code linéaire : donc sa distance est égale au minimum du poid de hamming de chaque mot (non nul)
    int res = 0;

    //On cherche tous les codes possible à 4 bits
    for(unsigned short i = 0; i<2<<(N-1); i++){
        unsigned short m = encode_simplexe(i<<(16-N));
        int nb_bits = cnt_bits(m);
        if (nb_bits != 0 || nb_bits < res){
            res = nb_bits;
        }
    }
    return res;
}

//Renvoie le syndrome d'un mot codé
unsigned short get_syndrome(unsigned short m){
    unsigned short res = ZERO;
    for(int i = 0; i<NHT; i++){
        res ^= hsT[i] & (get_nth_bit(i, m) ? ONE : ZERO);
    }
    return res<<(16-NH);
}

//Affiche toutes les erreurs (jusqu'à 3 bits d'erreurs) et le syndrommes associés
void compute_syndromes(){
    unsigned short mot = encode_simplexe(0b1010000000000000);
    for(unsigned short i = 1; i<(2<<14); i++){
        if(cnt_bits(i) < 4){
            print_word(15, i<<1);
            print_word(11,get_syndrome(mot ^ (i<<1)));
        }
    }
}

//Corrige un mot si c'est possible, sinon, renvoie le mot non corrigé
unsigned short decode(unsigned short m){
    unsigned short syndrome = get_syndrome(m);
    if(syndrome != 0){
        int idx = -1;
        //On cherche le syndromme
        for(int i = 0; i<NB_ERRORS; i++){
            if(syndrome == syndromes[i]){
                idx = i;
                break;
            }
        }

        //Si on l'a trouvé on corrige l'erreur
        if(idx>=0){
            m ^= errors[idx];
        }
        //Sinon, on renvoie le mot et un message d'erreur
        else{
            printf("Erreur détectée, correction impossible.\n");
        }
    }
    return m;
}

//Calcule le module d'un mot par le polynome générateur
unsigned short mod_poly_simplex(unsigned short m){
    for(int i = 0; i<4; i++){ 
        m ^= SHIFT_REGISTER & (get_nth_bit(0, m) ? ONE : ZERO);
        m <<=1;
    }
    return m;
}

//Renvoie un mot corrigé avec la méthode polynome
unsigned short decode_poly(unsigned short m){
    unsigned short syndrome = mod_poly_simplex(m);
    int nb_bits_syndrome = cnt_bits(syndrome);

    if(nb_bits_syndrome != 0){

        int nb_shifts = 0;
        while(nb_bits_syndrome > 3 && nb_shifts < 15){
            m = circular_shift(m, 1, 0);
            nb_shifts++;

            syndrome = mod_poly_simplex(m);
            nb_bits_syndrome = cnt_bits(syndrome);
        }

        if(nb_shifts < 15){
            // On ajoute le syndrome au message
            m ^= syndrome>>4;
        }
        else{
            printf("Erreur détectée, correction impossible.\n");
        }
        
        //On redécale dans le sens inverse
        m = circular_shift(m, nb_shifts, 1);
    }

    return m;
}

//Fait un décallage circulaire (15 bits) (0 pour la gauche, 1 pour la droite)
unsigned short circular_shift(unsigned short m, int nb_shits, char direction){
    for(int i = 0; i<nb_shits; i++){
        if(direction){
            unsigned short last = get_nth_bit(14, m);
            m>>=1;
            if(last){
                m = set_nth_bit(0, m);
            }
        }
        else{
            unsigned short first = get_nth_bit(0, m);
            m<<=1;
            if(first){
                m = set_nth_bit(14, m);
            }
        }
    }
    return m;
}

//Code un mot avec la méthode polynome
unsigned short code_poly(unsigned short m){
    return m | (mod_poly_simplex(m) >> 4);
}

//Décode un fichier avec la méthode polynome
void decode_file_poly(char* input, char *output){
    FILE *f_input = fopen(input,"rb");
    FILE *f_output = fopen(output,"wb");
    
    char buffer[4];
    char res;
    do{
        buffer[0] = fgetc(f_input);
        buffer[1] = fgetc(f_input);
        buffer[2] = fgetc(f_input);
        buffer[3] = fgetc(f_input);
        if (feof(f_input)){
            break;
        }

        //On décode le premier couple d'octets
        res = decode_poly(buffer[0]<<8 | (0x00ff & buffer[1]))>>8;
        res &= 0x00f0;

        //On décode le second couple d'octets
        res |= decode_poly(buffer[2]<<8 | (0x00ff & buffer[3]))>>12;
        res &= 0x00ff;

        fwrite(&res, sizeof(char), 1, f_output); 
    } while(1);
 
    fclose(f_input);
    fclose(f_output);
}

//Encode un fichier avec la méthode polynome
void encode_file_poly(char* input, char *output){
    FILE *f_input = fopen(input,"rb");
    FILE *f_output = fopen(output,"wb");
    
    char buffer;
    unsigned short res;
    char a;
    do{
        buffer = fgetc(f_input);
        if (feof(f_input)){
            break;
        }

        //Première moitié de l'octet
        res = code_poly((buffer << 8) & 0xf000);
        res = create_noise(res);
        a = (char)(res>>8);
        fwrite(&a, sizeof(char),1, f_output);
        fwrite(&res, sizeof(char),1, f_output);


        //Seconde moitiée de l'octet
        res = code_poly((buffer << 12) & 0xf000);
        res = create_noise(res);
        a = (char)(res>>8);
        fwrite(&a, sizeof(char),1, f_output);
        fwrite(&res, sizeof(char),1, f_output);
    } while(1);

 
    fclose(f_input);
    fclose(f_output);
}

//Crée jusqu'à trois erreurs dans le mot. Retourne le mot modifié
unsigned short create_noise(unsigned short m){
    int nb_errors = rand()%4;
    for(int i=0; i<nb_errors; i++){
        m = chg_nth_bit(rand()%15, m);
    }

    return m;
}